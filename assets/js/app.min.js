"use strict";function _toConsumableArray(e){return _arrayWithoutHoles(e)||_iterableToArray(e)||_unsupportedIterableToArray(e)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray(e,t){if(e){if("string"==typeof e)return _arrayLikeToArray(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?_arrayLikeToArray(e,t):void 0}}function _iterableToArray(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}function _arrayWithoutHoles(e){if(Array.isArray(e))return _arrayLikeToArray(e)}function _arrayLikeToArray(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function _createClass(e,t,n){return t&&_defineProperties(e.prototype,t),n&&_defineProperties(e,n),e}var TodoModel=function(){function e(){_classCallCheck(this,e),this.store=localStorage}return _createClass(e,[{key:"getTodos",value:function(){var e=this.store.getItem("todos");if(e)return e=JSON.parse(e),_toConsumableArray(e)}},{key:"getMaiorID",value:function(){var e=this.getUserTodos(),t=0;return e&&e.map(function(e){e.id>t&&(t=e.id)}),t}},{key:"getUserTodos",value:function(){var e=this.getTodos(),t=this.getUserID(),n=[];return e&&(n=e.filter(function(e){return e.userID===t})),n}},{key:"getUserID",value:function(){var e=this.store.getItem("logado");if(e)return JSON.parse(e).id}},{key:"salvarTodo",value:function(e,t,n,r){var a=(a=this.getTodos())||[],r={id:this.getMaiorID()+1,userID:this.getUserID(),titulo:e,descricao:t,date:n,status:r};a.push(r),this.store.setItem("todos",JSON.stringify(a))}},{key:"deleteALL",value:function(){this.store.removeItem("todos")}}]),e}(),todoModel=new TodoModel;function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function _createClass(e,t,n){return t&&_defineProperties(e.prototype,t),n&&_defineProperties(e,n),e}var UserModel=function(){function e(){_classCallCheck(this,e),this.store=localStorage}return _createClass(e,[{key:"salvaUser",value:function(e,t,n){var r=this.getUsers(),a=[],o=1;r&&(a=JSON.parse(r),o=parseInt(a.length)+1);n={id:o,nome:e,email:t,senha:n};return a.push(n),this.store.setItem("usuarios",JSON.stringify(a)),this.setLogado(o,e),this.getLogado()}},{key:"setLogado",value:function(e,t){this.store.setItem("logado",JSON.stringify({id:e,nome:t}))}},{key:"getLogado",value:function(){return this.store.getItem("logado")}},{key:"getUsers",value:function(){return this.store.getItem("usuarios")}},{key:"logout",value:function(){this.store.removeItem("logado")}}]),e}(),userModel=new UserModel,BotaoSair=function(){return'<button data-view="ViewPrincipal" class="btn btn-logout btn-red">Sair</button>'},ViewCreateAtividade=function(){return'<div class="viewBase modalAtividade clearfix">\n        <h2>Digite os dados de sua atividade</h2>\n        <form>\n            <input type="text" name="titulo" placeholder="Digite o título da atividade">\n            <textarea name="descricao" rows="4" cols="50"></textarea>\n\n            <div class="formRow clearfix">\n                <input name="date" type="date">\n                <select name="status">\n                    <option value="0">Backlog</option>\n                    <option value="1">Em Andamento</option>\n                    <option value="2">Finalizado</option>\n                </select>\n            </div>\n            \n            <button class="btn btn-solid btn-cancelar">Cancelar</button>\n            <button class="btn btn-unfilled btn-create">Criar Atividade</button>\n        </form>\n    </div>'},ViewLogin=function(){return'<div class="viewBase viewLogin clearfix">\n        <h2>Faça Login para continuar</h2>\n        <form>\n            <input type="text" name="email" placeholder="Digite seu email">\n            <input type="password" name="senha" placeholder="Digite sua senha">\n            <button data-view="ViewPrincipal" class="btn btn-solid btn-voltar">Voltar</button>\n            <button data-view="ViewTodo" class="btn btn-unfilled btn-logar">Logar</button>\n        </form>\n    </div>'},ViewPrincipal=function(){return'<div class="viewBase clearfix">\n<h2>Bem vindo(a) a Magic TODO</h2>\n<p>Faça login ou registre-se para continuar</p>\n<button data-view="ViewLogin" class="btn btn-solid btn-navigate">Acessar Conta</button>\n<button data-view="ViewRegistrar" class="btn btn-unfilled btn-navigate">Registrar-se</button>\n</div>'},viewRegistrar=function(){return'<div class="viewBase viewRegistrarUsuario clearfix">\n        <h2>Digite seus dados para realizar seu cadastro!</h2>\n        <form>\n            <input type="text"  name="nome" placeholder="Digite seu nome">\n            <input type="email"  name="email" placeholder="Digite seu email">\n            <input type="password"  name="senha" placeholder="Digite sua senha">\n            <input type="password"  name="senha2" placeholder="Digite sua senha novamente">\n            <button data-view="ViewPrincipal" class="btn btn-solid btn-voltar">Voltar</button>\n            <button data-view="ViewTodo" class="btn btn-unfilled btn-registrar">Registrar-se</button>\n        </form>\n    </div>'},ViewTodo=function(){return'<div class="viewBase viewTodo clearfix">\n        <h2>Bem vindo(a)</h2>\n        <p>Aqui estão suas atividades registradas</p>\n        <div class="tableContainer">\n            <table>\n                <thead>\n                    <th>Id</th>\n                    <th>Título</th>\n                    <th>Data</th>\n                    <th>Status</th>\n                </thead>\n                <tbody class="listaTODOS">\n                \n                </tbody>\n            </table>\n        </div>\n        <button class="btn btn-solid btn-adicionar">Adicionar Atividade</button>\n        </div>'};function _toConsumableArray(e){return _arrayWithoutHoles(e)||_iterableToArray(e)||_unsupportedIterableToArray(e)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray(e,t){if(e){if("string"==typeof e)return _arrayLikeToArray(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?_arrayLikeToArray(e,t):void 0}}function _iterableToArray(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}function _arrayWithoutHoles(e){if(Array.isArray(e))return _arrayLikeToArray(e)}function _arrayLikeToArray(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function _createClass(e,t,n){return t&&_defineProperties(e.prototype,t),n&&_defineProperties(e,n),e}var ControllerInicial=function(){function e(){_classCallCheck(this,e),this.appElement=document.querySelector("#appContainer"),this.bindListeners(),this.verificaLogin()}return _createClass(e,[{key:"bindListeners",value:function(){var e=document.querySelectorAll(".btn-navigate");(e=_toConsumableArray(e)).map(function(e){e.addEventListener("click",function(e){e.preventDefault(),mudarView(e)})})}},{key:"verificaLogin",value:function(){userModel.getLogado()&&(renderTodos(),renderBotaoSair())}}]),e}();function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function _createClass(e,t,n){return t&&_defineProperties(e.prototype,t),n&&_defineProperties(e,n),e}var ControllerLogin=function(){function e(){_classCallCheck(this,e),this.appElement=document.querySelector("#appContainer")}return _createClass(e,[{key:"bindListeners",value:function(){var t=this,e=document.querySelector(".btn-logar");document.querySelector(".btn-voltar").addEventListener("click",function(e){e.preventDefault(),mudarView(e)}),e.addEventListener("click",function(e){e.preventDefault(),t.efetuarLogin(e)})}},{key:"efetuarLogin",value:function(t){var e=userModel.getUsers(),e=JSON.parse(e),n=document.querySelector('[name="email"]'),r=document.querySelector('[name="senha"]');e.map(function(e){e.email===n.value&&e.senha===r.value&&(userModel.setLogado(e.id,e.nome),mudarView(t),renderBotaoSair())})}}]),e}();function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function _createClass(e,t,n){return t&&_defineProperties(e.prototype,t),n&&_defineProperties(e,n),e}var ControllerRegistrar=function(){function e(){_classCallCheck(this,e),this.appElement=document.querySelector("#appContainer")}return _createClass(e,[{key:"bindListeners",value:function(){var t=this,e=document.querySelector(".btn-registrar");document.querySelector(".btn-voltar").addEventListener("click",function(e){e.preventDefault(),mudarView(e)}),e.addEventListener("click",function(e){e.preventDefault(),t.registrarUser(e)})}},{key:"registrarUser",value:function(e){var t,n=[],r=userModel.getUsers(),a=document.querySelector('[name="nome"]'),o=document.querySelector('[name="email"]'),i=document.querySelector('[name="senha"]'),l=document.querySelector('[name="senha2"]');r&&(r=JSON.parse(r)).map(function(e){e.email===o.value&&n.push("Já existe um usuário com este email!")}),o.value?/^(([^<>()[\]\\.,;:\s@\"]+(\.[^<>()[\]\\.,;:\s@\"]+)*)|(\".+\"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/.test(o.value)||n.push("Email inválido!"):n.push("Campo de Email Vazio!"),i.value!==l.value?n.push("As senhas são diferentes!"):(i.value.length<6||l.value.length<6)&&n.push("As senhas tem menos de 6 caracteres!"),0<n.length?(t="",n.map(function(e){t+=e+"\n"}),alert(t)):(i=userModel.salvaUser(a.value,o.value,i.value))?(JSON.parse(i),mudarView(e),renderBotaoSair()):alert("Erro ao salvar o usuário!")}}]),e}();function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function _createClass(e,t,n){return t&&_defineProperties(e.prototype,t),n&&_defineProperties(e,n),e}var ControllerTodo=function(){function e(){_classCallCheck(this,e),this.appElement=document.querySelector("#appContainer"),setModalContent(ViewCreateAtividade())}return _createClass(e,[{key:"bindListeners",value:function(){this.bindAdicionar(),this.bindCreate(),this.bindCancelar()}},{key:"bindCreate",value:function(){var t=this,e=document.querySelector(".btn-create");e&&e.addEventListener("click",function(e){e.preventDefault(),t.adicionarTODO()})}},{key:"bindCancelar",value:function(){var t=this,e=document.querySelector(".btn-cancelar");e&&e.addEventListener("click",function(e){e.preventDefault(),closeModal(),setModalContent(ViewCreateAtividade()),t.bindListeners()})}},{key:"bindAdicionar",value:function(){var e=document.querySelector(".btn-adicionar");e&&e.addEventListener("click",function(e){e.preventDefault(),openModal()})}},{key:"adicionarTODO",value:function(){console.log("disparou");var e=document.querySelector('[name="titulo"]'),t=document.querySelector('[name="descricao"]'),n=document.querySelector('[name="date"]'),r=document.querySelector('[name="status"]');todoModel.salvarTodo(e.value,t.value,n.value,r.value),this.updateTodoDOM()}},{key:"updateTodoDOM",value:function(){var e=todoModel.getUserTodos(),t=document.querySelector(".listaTODOS"),n="";0<e.length&&e.map(function(e){var t="";switch(e.status){case"0":t="Backlog";break;case"1":t="Em andamento";break;case"2":t="Finalizado";break;default:t="Backlog"}n+="\n                    <tr>\n                        <td>".concat(e.id,'</td>\n                        <td>\n                        <button class="btn btn-solid btn-edit"\n                        data-id=').concat(e.id,"\n                        data-titulo=").concat(e.titulo,"\n                        data-descricao=").concat(e.descricao,"\n                        data-date=").concat(e.date,"\n                        data-status=").concat(e.status,"\n                        >").concat(e.titulo,"\n                        </button>\n                        </td>\n                        <td>").concat(e.date,"</td>\n                        <td>").concat(t,"</td>\n                    </tr>\n                ")}),t.innerHTML=n,setModalContent(ViewCreateAtividade()),this.bindListeners()}}]),e}(),mudarView=function(e){var t=document.querySelector("#appContainer");switch(e.target.dataset.view){case"ViewLogin":case"ViewLogin":t.innerHTML=ViewLogin(),controllerLogin.bindListeners();break;case"ViewRegistrar":t.innerHTML=viewRegistrar(),controllerRegistrar.bindListeners();break;case"ViewPrincipal":t.innerHTML=ViewPrincipal(),controllerInicial.bindListeners();break;case"ViewTodo":t.innerHTML=ViewTodo(),controllerTodo.bindListeners(),controllerTodo.updateTodoDOM()}},renderTodos=function(){document.querySelector("#appContainer").innerHTML=ViewTodo(),controllerTodo.updateTodoDOM()},renderBotaoSair=function(){var e,t,n=document.querySelector(".btn-logout");n||(e=document.querySelector(".headerContainer"),t=BotaoSair(),e.innerHTML+=t),(n=document.querySelector(".btn-logout")).addEventListener("click",function(e){e.preventDefault(),userModel.logout(),mudarView(e),removeBotaoSair()})},removeBotaoSair=function(){var e=document.querySelector(".btn-logout");e&&e.remove()},setModalContent=function(e){var t=document.querySelector(".modal");t&&(t.innerHTML=e)},openModal=function(){var e=document.querySelector(".modal"),t=document.querySelector("body");e.style.opacity&&0!=!e.style.opacity||(t.style.overflow="hidden",e.style.opacity=1,e.style.visibility="visible")},closeModal=function(){var e=document.querySelector(".modal"),t=document.querySelector("body");1==e.style.opacity&&(t.style.overflow="scroll",e.style.opacity=0,e.style.visibility="hidden")},controllerTodo=new ControllerTodo,controllerInicial=new ControllerInicial,controllerRegistrar=new ControllerRegistrar,controllerLogin=new ControllerLogin;