"use strict";function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function _createClass(e,t,r){return t&&_defineProperties(e.prototype,t),r&&_defineProperties(e,r),e}var UserModel=function(){function e(){_classCallCheck(this,e),this.store=localStorage}return _createClass(e,[{key:"salvaUser",value:function(e,t,r){var n=this.getUsers(),a=[],i=1;n&&(a=JSON.parse(n),i=parseInt(a.length)+1);r={id:i,nome:e,email:t,senha:r};return a.push(r),this.store.setItem("usuarios",JSON.stringify(a)),this.setLogado(i,e),this.getLogado()}},{key:"setLogado",value:function(e,t){this.store.setItem("logado",JSON.stringify({id:e,nome:t}))}},{key:"getLogado",value:function(){return this.store.getItem("logado")}},{key:"getUsers",value:function(){return this.store.getItem("usuarios")}},{key:"logout",value:function(){this.store.removeItem("logado")}}]),e}(),userModel=new UserModel,BotaoSair=function(){return'<button data-view="ViewPrincipal" class="btn btn-logout btn-red">Sair</button>'},ViewLogin=function(){return'<div class="viewBase viewLogin clearfix">\n        <h2>Faça Login para continuar</h2>\n        <form>\n            <input type="text" name="email" placeholder="Digite seu email">\n            <input type="password" name="senha" placeholder="Digite sua senha">\n            <button data-view="ViewPrincipal" class="btn btn-solid btn-voltar">Voltar</button>\n            <button data-view="viewAreaUsuario" class="btn btn-unfilled btn-logar">Logar</button>\n        </form>\n    </div>'},ViewPrincipal=function(){return'<div class="viewBase clearfix">\n<h2>Bem vindo(a) a Magic TODO</h2>\n<p>Faça login ou registre-se para continuar</p>\n<button data-view="ViewLogin" class="btn btn-solid btn-navigate">Acessar Conta</button>\n<button data-view="ViewRegistrar" class="btn btn-unfilled btn-navigate">Registrar-se</button>\n</div>'},viewRegistrar=function(){return'<div class="viewBase viewRegistrarUsuario clearfix">\n        <h2>Digite seus dados para realizar seu cadastro!</h2>\n        <form>\n            <input type="text"  name="nome" placeholder="Digite seu nome">\n            <input type="email"  name="email" placeholder="Digite seu email">\n            <input type="password"  name="senha" placeholder="Digite sua senha">\n            <input type="password"  name="senha2" placeholder="Digite sua senha novamente">\n            <button data-view="ViewPrincipal" class="btn btn-solid btn-voltar">Voltar</button>\n            <button data-view="viewAreaUsuario" class="btn btn-unfilled btn-registrar">Registrar-se</button>\n        </form>\n    </div>'};function _toConsumableArray(e){return _arrayWithoutHoles(e)||_iterableToArray(e)||_unsupportedIterableToArray(e)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray(e,t){if(e){if("string"==typeof e)return _arrayLikeToArray(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?_arrayLikeToArray(e,t):void 0}}function _iterableToArray(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}function _arrayWithoutHoles(e){if(Array.isArray(e))return _arrayLikeToArray(e)}function _arrayLikeToArray(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function _createClass(e,t,r){return t&&_defineProperties(e.prototype,t),r&&_defineProperties(e,r),e}var ControllerInicial=function(){function e(){_classCallCheck(this,e),this.appElement=document.querySelector("#appContainer"),this.bindListeners()}return _createClass(e,[{key:"bindListeners",value:function(){_toConsumableArray(document.querySelectorAll(".btn-navigate")).map(function(e){e.addEventListener("click",function(e){e.preventDefault(),mudarView(e)})})}}]),e}(),controllerInicial=new ControllerInicial;function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function _createClass(e,t,r){return t&&_defineProperties(e.prototype,t),r&&_defineProperties(e,r),e}var ControllerRegistrar=function(){function e(){_classCallCheck(this,e),this.appElement=document.querySelector("#appContainer")}return _createClass(e,[{key:"bindListeners",value:function(){var t=this,e=document.querySelector(".btn-registrar");document.querySelector(".btn-voltar").addEventListener("click",function(e){e.preventDefault(),mudarView(e)}),e.addEventListener("click",function(e){e.preventDefault(),t.registrarUser(e)})}},{key:"registrarUser",value:function(e){var t,r=[],n=userModel.getUsers(),a=document.querySelector('[name="nome"]'),i=document.querySelector('[name="email"]'),o=document.querySelector('[name="senha"]'),s=document.querySelector('[name="senha2"]');n&&(n=JSON.parse(n)).map(function(e){e.email===i.value&&r.push("Já existe um usuário com este email!")}),i.value?/^(([^<>()[\]\\.,;:\s@\"]+(\.[^<>()[\]\\.,;:\s@\"]+)*)|(\".+\"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/.test(i.value)||r.push("Email inválido!"):r.push("Campo de Email Vazio!"),o.value!==s.value?r.push("As senhas são diferentes!"):(o.value.length<6||s.value.length<6)&&r.push("As senhas tem menos de 6 caracteres!"),0<r.length?(t="",r.map(function(e){t+=e+"\n"}),alert(t)):(o=userModel.salvaUser(a.value,i.value,o.value))?(JSON.parse(o),mudarView(e),renderBotaoSair()):alert("Erro ao salvar o usuário!")}}]),e}(),mudarView=function(e){var t=document.querySelector("#appContainer");switch(e.target.dataset.view){case"ViewLogin":case"ViewLogin":t.innerHTML=ViewLogin();break;case"ViewRegistrar":t.innerHTML=viewRegistrar(),controllerRegistrar.bindListeners();break;case"ViewPrincipal":t.innerHTML=ViewPrincipal(),controllerInicial.bindListeners()}},renderBotaoSair=function(){var e,t,r=document.querySelector(".btn-logout");r||(e=document.querySelector(".headerContainer"),t=BotaoSair(),e.innerHTML+=t),(r=document.querySelector(".btn-logout")).addEventListener("click",function(e){e.preventDefault(),userModel.logout(),mudarView(e),removeBotaoSair()})},controllerInicial=new ControllerInicial,controllerRegistrar=new ControllerRegistrar;